#网关启动方式:LOCAL;ZOOKEEPER;MIX
start.mode=ZOOKEEPER


#---------------------------银联到核心Gateway Plus ----- begin -----------------------------------#
# 网关暴露的URL 接受银联的协议端口服务（需要扩展协议）
export.url=http://0.0.0.0:8090/GW.gateway.server.HttpGateway?filterChain=MQConnectorFilter&mqconnector=cmq01

# mq连接器
mqconnect.id=cmq01
mqconnect.cmq01.pattern=single
mqconnect.cmq01.target=smq01

# mq服务，包括外调rpc连接器和mq连接器
mqexport.id=smq01
mqexport.smq01.url=atvmq://0.0.0.0/gateway_mq01?&connector=mqConnector&group=1.0&version=1.0
mqexport.smq01.filterChain=ConnectorFilter,MQConnectorFilter
mqexport.smq01.connector=coreConnector
mqexport.smq01.mqconnector=cmq02
mqexport.smq01.pattern=single

# mq连接器
mqconnect.id=cmq02
mqconnect.cmq02.pattern=single
mqconnect.cmq02.target=smq02

# mq服务，接受消息返回给银联
mqexport.id=smq02
mqexport.smq02.url=atvmq://0.0.0.0/gateway_mq02?connector=mqConnector&group=2.0&version=2.0
mqexport.smq02.filterChain=ConnectorFilter
mqexport.smq02.connector=rpcConnector
mqexport.smq02.pattern=single
#---------------------------银联到核心Gateway Plus ----- end -----------------------------------#

#---------------------------核心到银联Gateway Plus ----- begin -----------------------------------#
# Gateway Plus暴露给核心的端口服务
export.url=http://0.0.0.0:9000/GW.gateway.server.HttpGateway2?filterChain=MQConnectorFilter&connector=rpcConnector&mqconnector=cmq03
# Gateway Plus暴露给银联的接收端口（需要扩展协议）
export.url=http://0.0.0.0:9001/GW.gateway.server.HttpGateway2?filterChain=MQConnectorFilter&connector=rpcConnector&mqconnector=cmq04

# mq连接器
mqconnect.id=cmq03
mqconnect.cmq03.pattern=duplex
mqconnect.cmq03.target=smq03

# mq服务，接收到mq上核心的请求，并发送给银联
mqexport.id=smq03
mqexport.smq03.url=atvmq://0.0.0.0/gateway_mq03?&connector=mqConnector&group=3.0&version=3.0
mqexport.smq03.filterChain=ConnectorFilter
mqexport.smq03.connector=coreConnector
mqexport.smq03.pattern=single

# mq连接器，把银联给的响应写到mq队列
mqconnect.id=cmq04
mqconnect.cmq04.pattern=single
mqconnect.cmq04.target=smq04

# mq服务，银联返回给mq的响应，写回给核心
mqexport.id=smq04
mqexport.smq04.url=atvmq://0.0.0.0/gateway_mq04?connector=mqConnector&group=4.0&version=4.0
mqexport.smq04.filterChain=MQConnectorFilter
mqexport.smq04.pattern=duplex
#---------------------------核心到银联Gateway Plus ----- end -----------------------------------#



# activityMQ服务器连接地址
activitymq.url=tcp://10.24.1.66:61616

# 黑白名单模式：黑白名单(BLACKWHITE)/BLACKLIST(黑名单)/白名单(WHITELIST)/非黑白名单模式(NONE)
blackwhite.type=WHITELIST
black.list=125.125.*.125
white.list=127.0.0.1;10.18.*.*

# 分组路由维度,从左到右,多个值之间使用英文逗号隔开
router.rule=areaId,channelId,consumerId

# 注册中URL
registry.url=zookeeper://127.0.0.1:2181?backup=&group=edsp&session=60000&timeout=5000

# 配置中心URL
mconf.url=zookeeper://127.0.0.1:2181?backup=&group=edsp&session=60000&timeout=5000

# RPC接出配置信息
rpc.client.url=rpc://0.0.0.0:0?pool_min=300&pool_max=300

##################
### 系统参数配置 ###
##################

### 黑白名单配置 ###
##################
# 黑白名单模式:BLACKLIST、WHITELIST、BLACKWHITELIST、NONE
blackwhite.type=WHITELIST
# 黑名单清单,多个表达式之间使用英文逗号隔开
black.list=127.0.0.1;10.24.1.*;10.24.2.10-10.24.2.50
# 白名单清单,多个表达式之间使用英文逗号隔开
white.list=127.0.0.1;10.24.1.*;10.24.2.10-10.24.2.50

### 故障重试配置 ###
##################
# 失败重试开关
failretry.enable=true
# 失败重试规则格式为:[错误码]=>最大重试次数
failretry.rule=404=>3,406=>3,409=>3

### 分组路由配置 ###
##################
# 分组路由维度
router.rule=areaId,channelId,serviceId

##########################################################################################

##################
### 参数过滤配置 ###
##################
### 产生过滤规则格式：
### parameter.id=[规则ID]
### parameter.[规则ID].key=[参数KEY]
### parameter.[规则ID].isNull=[是否允许参数为空]
### parameter.[规则ID].type=[参数值类型]
### parameter.[规则ID].length=[参数值长度]
##################
# 第1组
parameter.id=PR01
parameter.PR01.key=channelId
parameter.PR01.isNull=false
parameter.PR01.type=string
parameter.PR01.length=10
parameter.PR01.status=true
# 第2组
parameter.id=PR02
parameter.PR02.key=channelId
parameter.PR02.isNull=false
parameter.PR02.type=string
parameter.PR02.length=10
parameter.PR02.status=true

##########################################################################################

##################
### 分组路由配置 ###
##################
### 分组路由规则格式：
### router.id=[规则ID]
### router.[规则ID].rule=[路由规则]
### router.[规则ID].serviceAddr=[服务访问地址]
### router.[规则ID].routerStatus=[路由规则屏蔽状态]
##################
# 第1组规则
router.id=RR01
router.RR01.rule=(beijing|shenzheng),(weixin0[1-5]),(loginUser)
router.RR01.serviceAddr=login:1.0.0:S01
router.RR01.routerStatus=true
# 第2组规则
router.id=RR02
router.RR02.rule=(beijing),(weixin0[6-9]),(queryUser)
router.RR02.serviceAddr=queryUser:2.0.0:S01
router.RR02.routerStatus=false
# 第3组规则
router.id=RR03
router.RR03.rule=(shenzheng),(app0[1-5]),(registryUser)
router.RR03.serviceAddr=registryUser:1.0.0:S02
router.RR03.routerStatus=true